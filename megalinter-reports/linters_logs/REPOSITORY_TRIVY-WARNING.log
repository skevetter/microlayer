Results of trivy linter (version 0.66.0)
See documentation on https://megalinter.io/9.0.1/descriptors/repository_trivy/
-----------------------------------------------

❌ [ERROR] for workspace /github/workspace
Linter raw log:
2025-10-07T03:56:36Z	INFO	[vulndb] Need to update DB
2025-10-07T03:56:36Z	INFO	[vulndb] Downloading vulnerability DB...
2025-10-07T03:56:36Z	INFO	[vulndb] Downloading artifact...	repo="mirror.gcr.io/aquasec/trivy-db:2"
5.91 MiB / 72.06 MiB [----->_________________________________________________________] 8.20% ? p/s ?28.51 MiB / 72.06 MiB [------------------------>____________________________________] 39.56% ? p/s ?53.73 MiB / 72.06 MiB [--------------------------------------------->_______________] 74.56% ? p/s ?72.06 MiB / 72.06 MiB [--------------------------------------------->] 100.00% 110.12 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [--------------------------------------------->] 100.00% 110.12 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [--------------------------------------------->] 100.00% 110.12 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [--------------------------------------------->] 100.00% 103.02 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [--------------------------------------------->] 100.00% 103.02 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [--------------------------------------------->] 100.00% 103.02 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 96.37 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 96.37 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 96.37 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 90.16 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 90.16 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 90.16 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 84.34 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 84.34 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 84.34 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 78.90 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 78.90 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 78.90 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 73.81 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 73.81 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 73.81 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 69.05 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 69.05 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [---------------------------------------------->] 100.00% 69.05 MiB p/s ETA 0s72.06 MiB / 72.06 MiB [-------------------------------------------------] 100.00% 13.73 MiB p/s 5.4s2025-10-07T03:56:42Z	INFO	[vulndb] Artifact successfully downloaded	repo="mirror.gcr.io/aquasec/trivy-db:2"
2025-10-07T03:56:42Z	INFO	[vuln] Vulnerability scanning is enabled
2025-10-07T03:56:42Z	INFO	[misconfig] Misconfiguration scanning is enabled
2025-10-07T03:56:42Z	INFO	[misconfig] Need to update the checks bundle
2025-10-07T03:56:42Z	INFO	[misconfig] Downloading the checks bundle...
165.20 KiB / 165.20 KiB [------------------------------------------------------] 100.00% ? p/s 100ms2025-10-07T03:56:45Z	INFO	[npm] To collect the license information of packages, "npm install" needs to be performed beforehand	dir="node_modules"
2025-10-07T03:56:45Z	INFO	Suppressing dependencies for development and testing. To display them, try the '--include-dev-deps' flag.
2025-10-07T03:56:45Z	INFO	Number of language-specific files	num=2
2025-10-07T03:56:45Z	INFO	[cargo] Detecting vulnerabilities...
2025-10-07T03:56:45Z	INFO	Detected config files	num=4

Report Summary

┌─────────────────────────────────┬────────────┬─────────────────┬───────────────────┐
│             Target              │    Type    │ Vulnerabilities │ Misconfigurations │
├─────────────────────────────────┼────────────┼─────────────────┼───────────────────┤
│ Cargo.lock                      │   cargo    │        0        │         -         │
├─────────────────────────────────┼────────────┼─────────────────┼───────────────────┤
│ Dockerfile                      │ dockerfile │        -        │         2         │
├─────────────────────────────────┼────────────┼─────────────────┼───────────────────┤
│ examples/Dockerfile.alpine      │ dockerfile │        -        │         2         │
├─────────────────────────────────┼────────────┼─────────────────┼───────────────────┤
│ examples/Dockerfile.traditional │ dockerfile │        -        │         3         │
├─────────────────────────────────┼────────────┼─────────────────┼───────────────────┤
│ examples/Dockerfile.ubuntu      │ dockerfile │        -        │         2         │
└─────────────────────────────────┴────────────┴─────────────────┴───────────────────┘
Legend:
- '-': Not scanned
- '0': Clean (no security findings detected)


Dockerfile (dockerfile)
=======================
Tests: 27 (SUCCESSES: 25, FAILURES: 2)
Failures: 2 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 1, CRITICAL: 0)

AVD-DS-0002 (HIGH): Specify at least 1 USER command in Dockerfile with non-root user as argument
════════════════════════════════════════
Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.

See https://avd.aquasec.com/misconfig/ds002
────────────────────────────────────────


AVD-DS-0026 (LOW): Add HEALTHCHECK instruction in your Dockerfile
════════════════════════════════════════
You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.

See https://avd.aquasec.com/misconfig/ds026
────────────────────────────────────────



examples/Dockerfile.alpine (dockerfile)
=======================================
Tests: 27 (SUCCESSES: 25, FAILURES: 2)
Failures: 2 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 1, CRITICAL: 0)

AVD-DS-0002 (HIGH): Specify at least 1 USER command in Dockerfile with non-root user as argument
════════════════════════════════════════
Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.

See https://avd.aquasec.com/misconfig/ds002
────────────────────────────────────────


AVD-DS-0026 (LOW): Add HEALTHCHECK instruction in your Dockerfile
════════════════════════════════════════
You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.

See https://avd.aquasec.com/misconfig/ds026
────────────────────────────────────────



examples/Dockerfile.traditional (dockerfile)
============================================
Tests: 27 (SUCCESSES: 24, FAILURES: 3)
Failures: 3 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 2, CRITICAL: 0)

AVD-DS-0002 (HIGH): Specify at least 1 USER command in Dockerfile with non-root user as argument
════════════════════════════════════════
Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.

See https://avd.aquasec.com/misconfig/ds002
────────────────────────────────────────


AVD-DS-0026 (LOW): Add HEALTHCHECK instruction in your Dockerfile
════════════════════════════════════════
You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.

See https://avd.aquasec.com/misconfig/ds026
────────────────────────────────────────


AVD-DS-0029 (HIGH): '--no-install-recommends' flag is missed: 'apt-get update && apt-get install -y curl git htop'
════════════════════════════════════════
'apt-get' install should use '--no-install-recommends' to minimize image size.

See https://avd.aquasec.com/misconfig/ds029
────────────────────────────────────────
 examples/Dockerfile.traditional:5
────────────────────────────────────────
   5 [ RUN apt-get update && apt-get install -y curl git htop
────────────────────────────────────────



examples/Dockerfile.ubuntu (dockerfile)
=======================================
Tests: 27 (SUCCESSES: 25, FAILURES: 2)
Failures: 2 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 1, CRITICAL: 0)

AVD-DS-0002 (HIGH): Specify at least 1 USER command in Dockerfile with non-root user as argument
════════════════════════════════════════
Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.

See https://avd.aquasec.com/misconfig/ds002
────────────────────────────────────────


AVD-DS-0026 (LOW): Add HEALTHCHECK instruction in your Dockerfile
════════════════════════════════════════
You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.

See https://avd.aquasec.com/misconfig/ds026
────────────────────────────────────────



📣 Notices:
  - Version 0.67.0 of Trivy is now available, current version is 0.66.0

To suppress version checks, run Trivy scans with the --skip-version-check flag


